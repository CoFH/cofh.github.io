{%- if page.version and page.mod -%}
  {%- assign version-docs = docs-by-version | find: "name", page.version -%}
  {%- assign mod-docs = version-docs.items | where: "mod", page.mod -%}
  {%- assign grouped-mod-docs = mod-docs | group_by_exp: "doc", "doc.category" | sort: "name", "first" -%}
  
  {%- capture mod-main-doc-url -%}/docs/{{page.version}}/{{page.mod | slugify}}/{%- endcapture -%}
  {%- assign mod-main-doc = mod-docs | find: "url", mod-main-doc-url -%}
  
  <table class="nav-table">
    <thead>
      <tr>
        <th colspan=2>
          <a href="{{mod-main-doc-url}}">{{ page.mod }} {{ page.version }}</a>
        </th>
      </tr>
    </thead>
    <tbody>
      {%- for cat-docs in grouped-mod-docs -%}
        {%- unless cat-docs.items.size < 2 and cat-docs.name == mod-main-doc.category -%}
          {%- if cat-docs.name -%}
            <tr>
              <th colspan=2>
                {%- assign cat-main-doc = cat-docs.items | find: "category-main", true -%}
                {%- if cat-main-doc -%}<a href="{{cat-main-doc.url}}">{%- endif -%}
                  {% include util/capitalize.html string=cat-docs.name %}
                {%- if cat-main-doc -%}</a>{%- endif -%}
              </th>
            </tr>
          {%- endif -%}
          
          {%- assign grouped-cat-docs = cat-docs.items | group_by_exp: "doc", "doc.subcategory" | sort: "name", "first" -%}
          {%- for subcat-docs in grouped-cat-docs -%}
            {%- unless cat-main-doc and subcat-docs.items.size < 2 and subcat-docs.name == cat-main-doc.subcategory -%}
              <tr>
                {%- if subcat-docs.name -%}
                  <th>
                    {%- assign subcat-main-doc = subcat-docs.items | find: "subcategory-main", true -%}
                    {%- if subcat-main-doc -%}<a href="{{subcat-main-doc.url}}">{%- endif -%}
                      {% include util/capitalize.html string=subcat-docs.name %}
                    {%- if subcat-main-doc -%}</a>{%- endif -%}
                  </th>
                {%- endif -%}
                <td{% unless subcat-docs.name %} colspan=2{% if grouped-cat-docs.size < 2 %} style="text-align:center;"{% endif %}{% endunless %}>
                  {%- assign counter = 0 -%}
                  {%- for doc in subcat-docs.items -%}
                    {%- unless doc.navbox-hidden or doc == mod-main-doc or doc == cat-main-doc or doc == subcat-main-doc -%}
                      {%- unless counter < 1 -%}&nbsp;â€¢ {% endunless -%}
                      
                      {%- assign icon = nil -%}
                      <a href="{{doc.url}}" class="docs-navbox-link">
                        {%- if doc.icon -%}
                          {% include docs/icon.html ids=doc.icon version=doc.version %}&nbsp;
                        {%- elsif doc.subjects -%}
                          {% include docs/icon.html ids=doc.subjects version=doc.version %}&nbsp;
                        {%- endif -%}
                        {{doc.title}}
                      </a>
                      
                      {%- assign counter = counter | plus: 1 -%}
                    {%- endunless -%}
                  {%- endfor -%}
                </td> 
              </tr>
            {%- endunless -%}
          {%- endfor -%}
        {%- endunless -%}
      {%- endfor -%}
    </tbody>
  </table>
{%- endif -%}